YUI.add("hermes-template-person-card",function(a,n){var l=a.Template.Handlebars.revive({1:function(a,n,l,e,t){var s;return"\t\t\t\t\t"+a.escapeExpression(a.lambda(null!=(s=null!=n?n.person:n)?s.realname:s,n))+"\n\t\t\t\t\t"+(null!=(s=l.if.call(null!=n?n:{},null!=n?n.personLocation:n,{name:"if",hash:{},fn:a.program(2,t,0),inverse:a.noop,data:t}))?s:"")+"\n"},2:function(a,n,l,e,t){return" - "},4:function(a,n,l,e,t){var s;return null!=(s=l.each.call(null!=n?n:{},null!=n?n.photostream:n,{name:"each",hash:{},fn:a.program(5,t,0),inverse:a.noop,data:t}))?s:""},5:function(a,n,l,e,t){var s;return null!=(s=l.if.call(null!=n?n:{},null!=n?n.needsInterstitial:n,{name:"if",hash:{},fn:a.program(6,t,0),inverse:a.program(8,t,0),data:t}))?s:""},6:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression,c=a.lambda;return'\t\t\t\t\t<a href="'+u("function"==typeof(r=null!=(r=l.url||(null!=n?n.url:n))?r:o)?r.call(i,{name:"url",hash:{},data:t}):r)+'" title="'+u("function"==typeof(r=null!=(r=l.title||(null!=n?n.title:n))?r:o)?r.call(i,{name:"title",hash:{},data:t}):r)+'" width="'+u(c(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.width:s,n))+'" height="'+u(c(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.height:s,n))+'" style="background: url(https://s.yimg.com/pw/images/spaceball.gif);" data-track="personCardRecentPhotosClick"></a>\n'},8:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression;return'\t\t\t\t\t<a href="'+u("function"==typeof(r=null!=(r=l.url||(null!=n?n.url:n))?r:o)?r.call(i,{name:"url",hash:{},data:t}):r)+'" title="'+u("function"==typeof(r=null!=(r=l.title||(null!=n?n.title:n))?r:o)?r.call(i,{name:"title",hash:{},data:t}):r)+'" style="background: url('+u(a.lambda(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.displayUrl:s,n))+');" data-track="personCardRecentPhotosClick"></a>\n'},10:function(a,n,l,e,t){return'\t\t\t<span class="tertiary">'+a.escapeExpression((l.intlMessage||n&&n.intlMessage||l.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"person.NO_PHOTOS"},data:t}))+"</span>\n"},compiler:[7,">= 4.0.0"],main:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression,c=a.lambda;return'\n<div>\n\t<section>\n\t\t<div class="follow-subview">'+u((l.outlet||n&&n.outlet||o).call(i,null!=n?n["follow-view"]:n,{name:"outlet",hash:{},data:t}))+'</div>\n\n\t\t<div class="attribution">\n\t\t\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.photostream:s,n))+'" data-track="personCardAttributionNameClick">\n\t\t\t\t<h3 class="fade-out">'+u(c(null!=(s=null!=n?n.person:n)?s.username:s,n))+'</h3>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="info">\n\t\t\t<span class="secondary realname fade-out">\n'+(null!=(s=l.if.call(i,null!=(s=null!=n?n.person:n)?s.realname:s,{name:"if",hash:{},fn:a.program(1,t,0),inverse:a.noop,data:t}))?s:"")+"\t\t\t\t"+u("function"==typeof(r=null!=(r=l.personLocation||(null!=n?n.personLocation:n))?r:o)?r.call(i,{name:"personLocation",hash:{},data:t}):r)+'\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div class="recent-photos">\n'+(null!=(s=l.if.call(i,null!=n?n.photostream:n,{name:"if",hash:{},fn:a.program(4,t,0),inverse:a.program(10,t,0),data:t}))?s:"")+'\t\t</div>\n\t</section>\n</div>\n\n<div class="links secondary">\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.sendFlickrMail:s,n))+'" data-track="personCardMessageClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.MESSAGE"},data:t}))+'</a>\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.albums:s,n))+'" data-track="personCardAlbumsClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.ALBUMS"},data:t}))+'</a>\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.favorites:s,n))+'" data-track="personCardFavesClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.FAVES"},data:t}))+'</a>\n\t<a class="align-right" href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.profile:s,n))+'" data-track="personCardProfileClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:t}))+"</a>\n</div>\n"},useData:!0}),e={};a.Array.each([],function(n){var l=a.Template.get("hermes/"+n);l&&(e[n]=l)}),a.Template.register("hermes/person-card",function(n,t){return t=t||{},t.partials=t.partials?a.merge(e,t.partials):e,l(n,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("person-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("person-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){var t=this,s={contentType:7};return this.nsid?s.id=this.nsid:s.pathAlias=this.pathAlias,new e.FlickrPromise({person:this.appContext.getModel("person-models",s),photostream:this.appContext.getModel("photostream-models",s),personProfile:this.appContext.getModel("person-profile-models",s)}).then(function(e){return t.personModel=e.person,t.personLocation=e.personProfile.getValue("location"),e.photostream.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.photostreamPhotos=e})},function(e){t.loadingError=!0,1===e.code&&"User not found"===e.message&&(t.badUser=!0)})},buildContainer:function(){var t,s;return this.loadingError?(s=this.badUser?'<span class="no-user">'+this.intlMessage({intlName:"person.NO_LONGER_ON_FLICKR"})+"</span>":'<span class="error-user">'+this.intlMessage({intlName:"person.ERROR_LOADING"})+"</span>",this.setContainerHTML(s)):(t=this.personModel.toJSON(),this.setContainerWithTemplate("person-card",{person:t,photostream:this.photostreamPhotos.map(function(e){return e.toJSON()}),personLocation:this.personLocation,personURLS:e.URLHelper.generatePersonUrls(this.personModel)})),this},activate:function(){var e=this.get("container"),t=e.one(".follow-view"),s=t.one(".relationship"),o=t.one(".relationship > .is-following"),n=e.one(".attribution");return s?o&&n.addClass("shorter"):n.addClass("full"),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-person-card","url-helper"],langBundles:["person","common"]});YUI.add("person-menu-view",function(e){var t=require("hermes-core/type-validator");e.namespace("Views")[this.name]=e.Base.create("person-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".no-menu"].concat(e.excludeSelectors||[]),this.personSelector=".avatar.person, .photo-attribution .attribution-icon, .comment-icon.circle-icon a, .show-person-menu",this.dialogCache=[],this.currentDialog,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},toJSON:function(){return e.merge(this.get("user"))},activate:function(){this.registerEventHandler(e.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.personSelector,this))},onClickTarget:function(t){var n;this.shouldProcessTarget(t.target)&&(t.preventDefault(),t.halt(),n=t.target.ancestor().one(this.personSelector)||t.target.ancestor(this.personSelector)||t.target.ancestor("a"),this.createParamsAndManageState(n),e.rapidTracker.beacon(this.name,"personCardOpened"))},shouldProcessTarget:function(e){return null!==e.ancestor()&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(e){var n,i={appContext:this.appContext,isActiveViewAgnostic:!0},r="";return(r=e.getData("person-nsid")||e.ancestor().getData("person-nsid"))||(0===(n=e.getAttribute("href")||e.ancestor().getAttribute("href")).indexOf("/photos")?r=n.replace("/photos/","").replace("/",""):0===n.indexOf("/groups/")&&(r=n.slice(n.lastIndexOf("/")+1))),i.disableRefreshOnRelationshipChange=e.hasClass("no-refresh"),t.nsid(r)?i.nsid=r:i.pathAlias=r,i.signature=r,i},createDialog:function(t,n){var i,r=this;this.fire("open"),e.fire("personMenuOpen"),this.dialogCache.some(function(e){return e.key===t.signature&&(i=e.dialog,!0)}),i?i.set("anchorElement",n.ancestor().hasClass("comment-icon")?n.ancestor():n):((i=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,anchorOffsetHorizontal:0,observePageResize:!0,anchorElement:n.ancestor().hasClass("comment-icon")?n.ancestor():n,subview:new e.Views["person-card-view"](t)})).on("clickOverlay",function(e){r.nextElClicked=[e.clientX,e.clientY]}),i.on("closeDroparound",function(){setTimeout(function(){if(r.nextElClicked){var t,n=document.elementFromPoint(r.nextElClicked[0],r.nextElClicked[1]);n&&(t=e.one(n))&&r.personSelector.split(",").some(function(e){return t.hasClass(e.replace(".",""))})&&r.shouldProcessTarget(t)&&r.createParamsAndManageState(t),r.nextElClicked=null}},10)}),this.dialogCache.length>10&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:i})),this.currentDialog=i,i.show()},closeDialog:function(){this.currentDialog&&(this.currentDialog.close(),e.fire("personMenuClose"))},destructor:function(){var t=this;this.currentDialog=null,e.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=[]}})},"@VERSION@",{requires:["flickr-promise","flickr-view","fluid-droparound-view","person-card-view"],langBundles:["person","common"]});YUI.add("hermes-template-group-card",function(a,n){var l=a.Template.Handlebars.revive({1:function(a,n,l,e,t){var s;return null!=(s=l.each.call(null!=n?n:{},null!=n?n.groupPool:n,{name:"each",hash:{},fn:a.program(2,t,0),inverse:a.noop,data:t}))?s:""},2:function(a,n,l,e,t){var s,r,i=null!=n?n:{},u=l.helperMissing,o=a.escapeExpression,p=a.lambda;return'\t\t\t\t\n\t\t\t\t<a href="'+o("function"==typeof(r=null!=(r=l.url||(null!=n?n.url:n))?r:u)?r.call(i,{name:"url",hash:{},data:t}):r)+'" title="'+o("function"==typeof(r=null!=(r=l.title||(null!=n?n.title:n))?r:u)?r.call(i,{name:"title",hash:{},data:t}):r)+'" width="'+o(p(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.width:s,n))+'" height="'+o(p(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.height:s,n))+'"\n'+(null!=(s=l.if.call(i,null!=n?n.needsInterstitial:n,{name:"if",hash:{},fn:a.program(3,t,0),inverse:a.program(5,t,0),data:t}))?s:"")+"\t\t\t\t></a>\n\t\t\t\t\n"},3:function(a,n,l,e,t){return'\t\t\t\t\tclass="restricted"\n'},5:function(a,n,l,e,t){var s;return'\t\t\t\t\tstyle="background: url('+a.escapeExpression(a.lambda(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.displayUrl:s,n))+');"\n'},7:function(a,n,l,e,t){var s;return null!=(s=l.if.call(null!=n?n:{},null!=n?n.canAddPhotos:n,{name:"if",hash:{},fn:a.program(8,t,0),inverse:a.program(10,t,0),data:t}))?s:""},8:function(a,n,l,e,t){var s,r=null!=n?n:{},i=l.helperMissing,u=a.escapeExpression;return'\t\t\t\t<p class="tertiary">'+u((l.intlMessage||n&&n.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"groups.BE_THE_FIRST"},data:t}))+'</p>\n\t\t\t\t<p class="tertiary"><a href="'+u(a.lambda(null!=(s=null!=n?n.groupURLS:n)?s.photos:s,n))+'">'+u((l.intlMessage||n&&n.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"groups.ADD_SOME_PHOTOS"},data:t}))+"</a></p>\n"},10:function(a,n,l,e,t){return"\t\t\t\t<p>"+a.escapeExpression((l.intlMessage||n&&n.intlMessage||l.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"groups.NO_PHOTOS"},data:t}))+"</p>\n"},12:function(a,n,l,e,t){var s,r=a.escapeExpression;return'\t<a href="'+r(a.lambda(null!=(s=null!=n?n.groupURLS:n)?s.admin:s,n))+'">'+r((l.intlMessage||n&&n.intlMessage||l.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:t}))+"</a>\n"},14:function(a,n,l,e,t){var s;return null!=(s=l.if.call(null!=n?n:{},null!=(s=null!=n?n.group:n)?s.isModerator:s,{name:"if",hash:{},fn:a.program(15,t,0),inverse:a.noop,data:t}))?s:""},15:function(a,n,l,e,t){var s,r=a.escapeExpression;return'\t\t<a href="'+r(a.lambda(null!=(s=null!=n?n.groupURLS:n)?s.admin:s,n))+'">'+r((l.intlMessage||n&&n.intlMessage||l.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:t}))+"</a>\n"},compiler:[7,">= 4.0.0"],main:function(a,n,l,e,t){var s,r=null!=n?n:{},i=l.helperMissing,u=a.escapeExpression,o=a.lambda;return'\n<div>\n\t<section>\n\t\t<div class="join-subview">\n\n\t\t\t'+u((l.outlet||n&&n.outlet||i).call(r,null!=n?n["join-group-view"]:n,{name:"outlet",hash:{},data:t}))+'\n\n\t\t</div>\n\n\t\t<div class="attribution">\n\t\t\t<a href="'+u(o(null!=(s=null!=n?n.groupURLS:n)?s.about:s,n))+'">\n\t\t\t\t<h3 class="fade-out">'+u((l.renderTrustedMarkup||n&&n.renderTrustedMarkup||i).call(r,null!=(s=null!=n?n.group:n)?s.title:s,{name:"renderTrustedMarkup",hash:{},data:t}))+'</h3>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="stats">\n\t\t\t<span class="secondary fade-out">'+u((l.intlMessage||n&&n.intlMessage||i).call(r,{name:"intlMessage",hash:{createdYear:null!=n?n.createdYear:n,intlName:"groups.CREATED_YEAR"},data:t}))+" - "+u((l.intlMessage||n&&n.intlMessage||i).call(r,{name:"intlMessage",hash:{updatedAgo:null!=n?n.updatedAgo:n,intlName:"groups.UPDATED_TIME_AGO"},data:t}))+'</span>\n\t\t</div>\n\n\t\t<div class="recent-photos">\n'+(null!=(s=l.if.call(r,null!=n?n.groupPool:n,{name:"if",hash:{},fn:a.program(1,t,0),inverse:a.program(7,t,0),data:t}))?s:"")+'\t\t</div>\n\t</section>\n</div>\n\n<div class="links secondary">\n\t<a href="'+u(o(null!=(s=null!=n?n.groupURLS:n)?s.photos:s,n))+'">'+u((l.intlMessage||n&&n.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"groups.PHOTOS_LINK_LABEL"},data:t}))+'</a>\n\t<a href="'+u(o(null!=(s=null!=n?n.groupURLS:n)?s.discussions:s,n))+'">'+u((l.intlMessage||n&&n.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"groups.DISCUSSIONS_LINK_LABEL"},data:t}))+"</a>\n"+(null!=(s=l.if.call(r,null!=(s=null!=n?n.group:n)?s.isAdmin:s,{name:"if",hash:{},fn:a.program(12,t,0),inverse:a.program(14,t,0),data:t}))?s:"")+"</div>"},useData:!0}),e={};a.Array.each([],function(n){var l=a.Template.get("hermes/"+n);l&&(e[n]=l)}),a.Template.register("hermes/group-card",function(n,t){return t=t||{},t.partials=t.partials?a.merge(e,t.partials):e,l(n,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("group-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("group-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.groupId=e.groupId,this.groupPathAlias=e.groupPathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"join-group-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,shortLabels:!0,theme:"light"}},loadState:function(){var t=this,r=this.groupId;return new e.FlickrPromise({groupPool:this.appContext.getModel("group-pool-models",r),group:this.appContext.getModel("group-models",r),groupInfo:this.appContext.getModel("group-info-models",r)}).then(function(e){return t.groupModel=e.group,t.groupInfo=e.groupInfo,e.groupPool.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.groupPhotos=e})},function(e){t.loadingError=!0})},buildContainer:function(){var t,r,o=!1;return this.loadingError?this.setContainerHTML('<span class="error-group">'+this.intlMessage({intlName:"groups.ERROR_LOADING"})+"</span>"):(t=this.groupModel.toJSON(),(o="disabled"!==(r=this.groupInfo.getValue("throttle")).mode&&r.remaining>0||"none"===r.mode)&&(o=t.isMember),this.setContainerWithTemplate("group-card",{group:t,groupPool:this.groupPhotos.map(function(e){return e.toJSON()}),canAddPhotos:o,groupURLS:e.URLHelper.generateGroupUrls(this.groupModel),createdYear:t.dateCreated.year(),updatedAgo:this.intlMessage(e.Handlebars.helpers._friendlySinceDate(t.latestGroupActivity,!0,!0))})),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",function(e){e.preventDefault()},".join")),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-group-card","url-helper","handlebars-helpers"],langBundles:["groups","relative-dates"]});YUI.add("group-menu-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create("group-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".large",".no-menu"].concat(e.excludeSelectors||[]),this.groupSelector=".avatar.group",this.dialogCache=[],this.currentDialog,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},activate:function(){this.registerEventHandler(e.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.groupSelector,this))},onClickTarget:function(e){var t;this.shouldProcessTarget(e.target)&&(e.preventDefault(),e.halt(),t=e.target,this.createParamsAndManageState(t))},shouldProcessTarget:function(e){return null!==e.ancestor()&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(e){var t={appContext:this.appContext,isActiveViewAgnostic:!0};return t.groupId=e.getData("group-nsid"),t.signature=t.groupId,t},createDialog:function(t,i){var n,a=this;this.fire("open"),this.dialogCache.some(function(e){return e.key===t.signature&&(n=e.dialog,!0)}),n?n.set("anchorElement",i):((n=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,observePageResize:!0,anchorElement:i,anchorOffsetHorizontal:4,subview:new e.Views["group-card-view"](t)})).on("clickOverlay",function(e){a.nextElClicked=[e.clientX,e.clientY]}),n.on("closeDroparound",function(){setTimeout(function(){if(a.nextElClicked){var t,i,n=document.elementFromPoint(a.nextElClicked[0],a.nextElClicked[1]);n&&(t=e.one(n),i=a.groupSelector.split(",").some(function(e){return t.hasClass(e.replace(".",""))}),t&&i&&a.shouldProcessTarget(t)&&a.createParamsAndManageState(t)),a.nextElClicked=null}},10)}),this.dialogCache.length>10&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:n})),this.currentDialog=n,n.show()},closeDialog:function(){this.currentDialog&&this.currentDialog.close()},destructor:function(){var t=this;this.currentDialog=null,e.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=null}})},"@VERSION@",{requires:["flickr-promise","flickr-view","fluid-droparound-view","group-card-view"],langBundles:["common"]});YUI.add("hermes-template-signup-interstitial",function(e,a){var s=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,s,t,i){var n=null!=a?a:{},l=s.helperMissing,r=e.escapeExpression;return'<div class="signup-interstitial-body interstitial-fade">\n\t<div class="close-x"></div>\n\t<div class="body">\n\t\t<div class="logo"></div>\n\t\t<h3 class="signup-interstitial-message">'+r((s.intlMessage||a&&a.intlMessage||l).call(n,{name:"intlMessage",hash:{intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_EXPLORE"},data:i}))+'</h3>\n\t\t<div><a href="/signup" class="butt large action signup-button">'+r((s.intlMessage||a&&a.intlMessage||l).call(n,{name:"intlMessage",hash:{intlName:"common.SIGN_UP_WITH_YAHOO"},data:i}))+'</a></div>\n\t\t<a href="/signin" class="signin-link">'+r((s.intlMessage||a&&a.intlMessage||l).call(n,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:i}))+"</a>\n\t</div>\n</div>\n"},useData:!0}),t={};e.Array.each([],function(a){var s=e.Template.get("hermes/"+a);s&&(t[a]=s)}),e.Template.register("hermes/signup-interstitial",function(a,i){return i=i||{},i.partials=i.partials?e.merge(t,i.partials):t,s(a,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("signup-interstitial-view",function(t,i){"use strict";var n;n={css:{destinationContainer:"body",closeX:".close-x",buttonAction:"button.action",navBarContent:".head .nav",subviewContent:".content.subview",modalContent:".body .content",modalSelector:".modal"},options:{}},t.namespace("Views").SignUpInterstitial=t.FlickrView.create(this.name,t.Views.FluidModal,[],{langBundles:this.details.langBundles,buildContainer:function(){var i=t.one(n.css.destinationContainer);if(!this.alreadyShowingModal){var e={signUpMessage:this.get("signUpMessage")};this.setContainerWithTemplate("signup-interstitial",e),i&&(i.append(this.get("container")),this.reposition(),this.get("modalOverlayType").get("overlay").removeClass("interstitial-fade"),this.get("container").one(".signup-interstitial-body").removeClass("interstitial-fade"))}return this},activate:function(){var t=this.get("container");this.registerEventHandler(t.one(".signup-button").on("click",this.instrumentSignupClick.bind(this))),this.registerEventHandler(t.one(".signin-link").on("click",this.instrumentSigninClick.bind(this))),this.constructor.superclass.activate.call(this)},instrumentSignupClick:function(n){t.rapidTracker.beacon(i,"signupIntSignupClick")},instrumentSigninClick:function(n){t.rapidTracker.beacon(i,"signupIntSigninClick")},show:function(){t.rapidTracker.beacon(i,"signupIntShown"),this.constructor.superclass.show.call(this)},close:function(n){t.rapidTracker.beacon(i,"signupIntCancelClick"),this.constructor.superclass.close.call(this,n)}},{ATTRS:{showFooter:{value:!1},showHeader:{value:!1},showButtonFlavorText:{value:!1},showButtons:{value:!1},showActionButton:{value:!1},showCancelButton:{value:!1},modalSelector:{value:".signup-interstitial-body"},modalOverlayType:{value:t.OverlayManager.SignupInterstitialOverlay}}})},"@VERSION@",{requires:["flickr-view","fluid-modal-view","hermes-template-signup-interstitial"],optionalRequires:["fluid"],langBundles:["common","growth"]});YUI.add("hermes-lang-growth",function(e,o){e.Intl.add("hermes/growth","en-US",{MINI_SIGNUP_FOOTER_MESSAGE:["Never miss a post from ","${username}"],MINI_SIGNUP_FOOTER_MESSAGE_EXPLORE:["Join Flickr to explore world class photos"],MINI_SIGNUP_FOOTER_MESSAGE_SEARCH:["Join Flickr to see more ","${query}"," photos!"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-partner-account-banner",function(e,a){var r=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,r,n,t){return'<div class="banner-container">\n\t<p>Dear Flickr Member: due to partnership changes with AT&T, you need to update your primary email address. <a class="learn-more">Learn more</a></p>\n</div>\n'},useData:!0}),n={};e.Array.each([],function(a){var r=e.Template.get("hermes/"+a);r&&(n[a]=r)}),e.Template.register("hermes/partner-account-banner",function(a,t){return t=t||{},t.partials=t.partials?e.merge(n,t.partials):n,r(a,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-partner-account-modal",function(e,t){var a=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,a,n,r){return'<div>\n\tWith the launch of the new att.net homepage on June 30, 2017, you will need to change the primary email address you use to sign into your Flickr/Yahoo account. Your data and photos on Flickr will not be deleted or modified in any way. You will need to complete this process before June 30, 2017 in order to continue accessing your Flickr account.\n\t<br/><br/>\n\t<a href="/partner-account">Click here to learn more about these changes.</a>\n\t<br/><br/>\n\t<a href="/account/transfer">\n\t\t<button class="update-email">Update your email address</button>\n\t</a>\n</div>\n'},useData:!0}),n={};e.Array.each([],function(t){var a=e.Template.get("hermes/"+t);a&&(n[t]=a)}),e.Template.register("hermes/partner-account-modal",function(t,r){return r=r||{},r.partials=r.partials?e.merge(n,r.partials):n,a(t,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("partner-account-banner-view",function(e,t){e.FlickrView.create(this.name,e.FlickrView,[],{buildContainer:function(){return this.setContainerWithTemplate("partner-account-banner"),this},activate:function(){var n=this.get("container").one(".learn-more");return n&&this.registerEventHandler(n.on("click",this.openModal.bind(this))),e.AnchorRepositioner.addOffset(t,this.get("container")),this},openModal:function(){new e.Views.FluidModal({title:"The way you sign in to Flickr is changing",htmlMessage:this.templates("partner-account-modal")({}),appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelX:!0,showCancelButton:!1,showActionButton:!1,hideModalOverlay:!1,showFooter:!1}).show()},destructor:function(){e.AnchorRepositioner.removeOffset(t)}})},"@VERSION@",{requires:["flickr-view","hermes-template-partner-account-banner","hermes-template-partner-account-modal"]});YUI.add("hermes-template-featured-toast",function(e,a){var r=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,r,t,s){return'<div class="featured-toast">\n\t'+e.escapeExpression((r.renderTrustedMarkup||a&&a.renderTrustedMarkup||r.helperMissing).call(null!=a?a:{},null!=a?a.htmlContent:a,{name:"renderTrustedMarkup",hash:{},data:s}))+"\n</div>\n"},useData:!0}),t={};e.Array.each([],function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)}),e.Template.register("hermes/featured-toast",function(a,s){return s=s||{},s.partials=s.partials?e.merge(t,s.partials):t,r(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("featured-toast-view",function(t){t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.params=t,this.config=t.featuredToastConfig,this.config.id=this.config.id||"",this.config.htmlContent=this.config.htmlContent||"",this.config.showOnActivate=void 0!==this.config.showOnActivate&&this.config.showOnActivate,this.config.classList=this.config.classList||[]},loadState:function(){return t.Promise.resolve()},buildContainer:function(){this.setContainerWithTemplate("featured-toast",{htmlContent:this.config.htmlContent,classList:this.config.classList})},activate:function(){var i=this,n=this.get("container");this.contentContainer=n.one(".featured-toast"),this.initialClasses=Array.prototype.slice.call(this.contentContainer.getDOMNode().classList),this.updateClasses(),this.setupEvents(),this.config.showOnActivate&&setTimeout(function(){i.show()},0),setTimeout(function(){i.applyBannerOffset()},100),this.registerEventHandler(t.on("resize",t.betterThrottle(this.applyBannerOffset.bind(this),500,this,!0))),this.fire("activated")},show:function(){this.get("container").addClass("activated")},dismiss:function(){var t=this.get("container");t.setStyle("bottom",null),t.removeClass("activated")},handlePrimaryActionClick:function(t){t.preventDefault(),t.stopPropagation(),this.fire("primaryActionClicked",{clickEvent:t})},handleSecondaryActionClick:function(t){t.preventDefault(),t.stopPropagation(),this.fire("secondaryActionClicked",{clickEvent:t})},applyBannerOffset:function(){var i,n=t.one(".footer-banner-view .footer-container");n&&(i=n.get("clientHeight"),this.get("container").setStyle("bottom",i))},setup:function(t){this.config.htmlContent=t.htmlContent||"",this.config.classList=t.classList||[],this.contentContainer.set("innerHTML",this.config.htmlContent),this.updateClasses(),this.setupEvents()},updateClasses:function(){var t=this;this.contentContainer.set("className",""),this.initialClasses.forEach(function(i){t.contentContainer.addClass(i)}),this.config.classList.forEach(function(i){t.contentContainer.addClass(i)})},setupEvents:function(){var t=this.get("container"),i=t.one(".primary-action"),n=t.one(".secondary-action");i&&i.on("click",this.handlePrimaryActionClick.bind(this)),n&&n.on("click",this.handleSecondaryActionClick.bind(this))}})},"@VERSION@",{requires:["flickr-view","hermes-template-featured-toast"]});YUI.add("hermes-template-featured-banner",function(e,a){var t=e.Template.Handlebars.revive({1:function(e,a,t,n,r){return'<a href="https://flickr.kustomer.help/en_us/add-and-verify-a-new-email-address-ry6qhVBV" target="_blank">Update your email address to get started</a>'},3:function(e,a,t,n,r){var l;return'<a href="'+e.escapeExpression("function"==typeof(l=null!=(l=t.migrateUrl||(null!=a?a.migrateUrl:a))?l:t.helperMissing)?l.call(null!=a?a:{},{name:"migrateUrl",hash:{},data:r}):l)+'">Update your login now</a>'},compiler:[7,">= 4.0.0"],main:function(e,a,t,n,r){var l;return'<div class="featured-banner">\n\t<div class="featured-banner-content fluid-centered">\n\t\t<div class="featured-text">\n\t\t\t<p>Changes are coming to the way you log into Flickr! '+(null!=(l=t.if.call(null!=a?a:{},null!=a?a.hasInvalidEmail:a,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.program(3,r,0),data:r}))?l:"")+'.</p>\n\t\t</div>\n\t\t<div class="button-container">\n\t\t\t<a role="button" class="dismiss">\n\t\t\t\t<svg class="icon icon-close"><use xlink:href="#icon-close"></use></svg>\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</div>\n'},useData:!0}),n={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(n[a]=t)}),e.Template.register("hermes/featured-banner",function(a,r){return r=r||{},r.partials=r.partials?e.merge(n,r.partials):n,t(a,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("featured-banner-view",function(e,i){var t=require("hermes-core/flog")(i);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.params=e},loadState:function(){var i=this.appContext.getViewer(),n=[];return i.signedIn?(this.set("isCognitoUser",i.isCognitoUser),n.push(this.appContext.getModel("person-models",i.nsid).then(function(e){this.set("hasInvalidEmail",e.getValue("hasInvalidEmail")),this.set("isPro",e.getValue("isPro"))}.bind(this))),n.push(this.appContext.getModel("person-profile-models",i.nsid).then(function(e){this.set("profileModel",e)}.bind(this))),n.push(this.appContext.callAPI("flickr.people.getInfo",{user_id:i.nsid,extras:"mu"}).then(function(e){e&&e.person&&e.person.mu?(this.set("hasAuthorizedMobile",e.person.mu),t.info("User is not eligible for the migration banner (mobile user/windows uploader)")):(t.info("User is eligible for the migration banner"),this.set("hasAuthorizedMobile",!1))}.bind(this))),e.Promise.all(n)):(this.set("isCognitoUser",0),e.Promise.resolve())},buildContainer:function(){return this.canSeeBanner()?(this.set("canSeeBanner",!0),this.setContainerWithTemplate("featured-banner",{hasInvalidEmail:this.get("hasInvalidEmail"),migrateUrl:e.config.flickr.cognito.root+e.config.flickr.cognito["migration-url"]})):(this.set("canSeeBanner",!1),this.setContainerHTML("")),this},activate:function(){var i=this.get("container");this.get("canSeeBanner")?(this.registerEventHandler(i.one(".dismiss").on("click",this.dismissBanner.bind(this))),e.Analytics&&e.Analytics.sendEvent("Login Migration","banner","Banner displayed")):this.setContainerHTML(""),this.appContext.getCookie("cmb")&&this.appContext.removeCookie({cookieName:"cmb",path:"/"})},dismissBanner:function(i){var t=new Date;t.setTime(t.getTime()+828e5),this.appContext.setCookie({cookieName:e.config.flickr.cognito["migration-banner-cookie-name"],cookieValue:1,expires:t,path:"/"}),this.setContainerHTML(""),e.Analytics&&e.Analytics.sendEvent("Login Migration","banner","Banner dismissed")},canSeeBanner:function(){var i=!1;return!this.appContext.getViewer().signedIn||this.get("isCognitoUser")||this.get("hasAuthorizedMobile")||this.appContext.getCookie(e.config.flickr.cognito["migration-banner-cookie-name"])||this.isSeeingRefencingBanners()||(i=!0),i},isSeeingRefencingBanners:function(){var i=!1;return!this.get("isPro")&&(e.UserLimitsHelper.isOverARRLimit(this.get("profileModel"),this.appContext)&&!this.appContext.getCookie(e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name)?i=!0:e.UserLimitsHelper.isNearUploadLimit(this.get("profileModel"),this.appContext)&&!this.appContext.getCookie(e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_name)?i=!0:e.UserLimitsHelper.isAtUploadLimit(this.get("profileModel"),this.appContext)&&!this.appContext.getCookie(e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_name)&&(i=!0),i)}})},"@VERSION@",{requires:["flickr-view","hermes-template-featured-banner","user-limits-helper","hermes-template-footer-banner","person-models","person-profile-models"]});YUI.add("global-nav-view",function(e,t){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i,n;if(void 0===t.enableBrowserUpgradeBanner&&(t.enableBrowserUpgradeBanner=!0),this.set("showBrowserUpgradeBanner",!1),YUI.Env.isServer&&t.enableBrowserUpgradeBanner){var o=this.appContext.request.headers["user-agent"],s=e.BrowserSupport.isUnsupportedBrowser(o),a=e.BrowserSupport.isBot(o),r=e.BrowserSupport.isSharingBot(o);!s||a||r||this.set("showBrowserUpgradeBanner",!0)}if(!YUI.Env.isServer){var l=e.StorageHelper.getItem("hasDismissedBrowserUpgradeBanner",!0);l&&"true"===l&&this.set("showBrowserUpgradeBanner",!1)}return""===this.get("container").get("innerHTML")&&this.setContainerHTML('<div class="global-nav-content"></div>'),this.appStateParams=t,this.themeClass=t.theme||"default-theme",i=this.appContext.getLocation(),n=t.modelParams&&t.modelParams.apiParams?t.modelParams.apiParams:i.href,this.searchUrl=new e.SearchUrl(n,this.appContext,t.searchType),this.appContext.flipper.isFlipped("enable-signed-out-cta-test")&&(this.signedOutTest=!0),this.appContext.flipper.isFlipped("enable-sign-up-interstitial-test")&&"en-us"===this.appContext.lang.toLowerCase()&&(this.signUpInterstitialTest=!0),!this.appContext.flipper.isFlipped("enable-sign-up-rail-test")||"en-us"!==this.appContext.lang.toLowerCase()||this.appContext.getViewer().signedIn||t.isSOHP||(this.signUpRailTest=!0),this.isSOHP=t.isSOHP,this.hideBanner=t.isSearchResults,this.isRefencingAnnouncementPage=t.isRefencingAnnouncementPage,t.featuredToastConfig={id:"upload-limit-warning-toast",showOnActivate:!1},this.uploadLimitDismissHours=48,this},subviewConfig:{"search-autosuggest-field-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,isSOHP:this.isSOHP},"account-menu-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"notifications-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("notifications-menu")}},"browser-upgrade-banner-view":{requiredToShowOnServer:!0,requiredToShowOnClient:!1,dealbreaker:!1,disabled:function(){return!this.get("showBrowserUpgradeBanner")}},"person-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!(this.appContext.flipper.isFlipped("enable-hover-account-menu")&&this.appContext.flipper.isFlipped("rebootify-group-discussions-list"))}},"group-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!(this.appContext.flipper.isFlipped("enable-hover-account-menu")&&this.appContext.flipper.isFlipped("rebootify-group-discussions-list"))}},"signup-rail-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["collapsed"],disabled:function(e){return e.isMobile||!this.signUpRailTest}},"flickr-chat-center-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(e){return!this.appContext.flipper.isFlipped("flickr-chat")||!this.appContext.getViewer().signedIn}},"partner-account-banner-view":{requiredToShowOnServer:!1,requiredToShowOnClient:!1},"featured-toast-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"featured-banner-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!(this.appContext.flipper.isFlipped("enable-cognito-migration-banner")&&this.appContext.getViewer().signedIn)}}},loadState:function(){var t=this,i=this.appContext.getViewer(),n=[];return i.signedIn?(n.push(this.appContext.getModel("person-models",i.nsid).then(function(e){t.set("viewer",e),t.elementStates=t.setElementStates(t.appStateParams),t.hideBanner?t.set("showPartnerAccountBanner",!1):t.set("showPartnerAccountBanner",t.isExpiringPartnerAccount())})),n.push(this.appContext.getModel("person-profile-models",i.nsid).then(function(e){t.profileModel=e}))):this.elementStates=this.setElementStates(this.appStateParams),e.Promise.all(n).then(function(){t.get("viewer");!YUI.Env.isServer&&t.appContext.flipper.isFlipped("enable-feedback-modal")&&"en-US"===t.appContext.lang&&!localStorage.getItem("feedbackModalSeen12_18")&&t.appContext.hasClientSideRouted()&&"photostream-route"!==this.appContext.routeConfig.module&&(t.meetsFeedbackCriteria=!0)})},buildContainer:function(){var t,i={},n=this.appContext.getViewer().signedIn;return this.get("viewer")&&(i=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),t={theme:this.themeClass,"show-browser-upgrade-banner":this.get("showBrowserUpgradeBanner"),showPartnerAccountBanner:this.get("showPartnerAccountBanner"),showNotificationsMenu:!1,viewer:i,isSignedIn:n,elements:this.elementStates,isRefencingAnnouncementPage:this.isRefencingAnnouncementPage,showFeaturedToast:(this.appContext.flipper.isFlipped("enable-upload-limit-warning")||this.appContext.flipper.isFlipped("enable-upload-limit-messages"))&&this.appContext.getViewer().signedIn},this.appContext.flipper.isFlipped("notifications-menu")&&n&&(t["notifications-menu-view"]=this.subviews["notifications-menu-view"].get("container"),t.showNotificationsMenu=!0),this.setContainerWithTemplate("global-nav",t),this},activate:function(){var i,n,o=this,s=(this.appContext.getViewer().prefs.keyboardShortcutsEnabled,this.get("container"));return n=["photo-page-ad-scrappy-view","sohp-view"],i=this.appContext.flapp.get("activeView").name,s.one(".mobile-nav-toggle")&&this.registerEventHandler(s.one(".mobile-nav-toggle").on("click",function(t){e.rapidTracker.beacon(o.name,"mobile-nav-toggle",{action:s.one(".global-nav").hasClass("menu-open")?"close":"open"}),s.one(".global-nav").toggleClass("menu-open")}.bind(this))),s.one(".mobile-search-button")?(this.registerEventHandler(s.one(".mobile-search-button").on("click",function(t){e.rapidTracker.beacon(o.name,"mobile-nav-search");var i=this.get("container"),n=i.one(".global-nav");n.addClass("search-open"),n.hasClass("menu-open")&&n.removeClass("menu-open"),o.fire("parentViewEvent","focus-search-field"),i.one(".flickr-logo-container").addClass("hidden")}.bind(this))),this.registerEventHandler(e.on("add-context-to-search-field",function(e){this.get("container").one(".global-nav").addClass("search-open"),o.fire("parentViewEvent","focus-search-field")},this))):this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(t){var i=e.config.win.innerWidth<=700,n=i?this.appContext.viewportData.getWidth():0,a=i?46:0;i||(s.one(".global-nav").removeClass("search-open"),s.one(".flickr-logo-container").removeClass("hidden")),o.fire("parentViewEvent","resize-search-field",n-a)}.bind(this))),s.one(".mobile-search-close-button")&&this.registerEventHandler(s.one(".mobile-search-close-button").on("click",function(e){s.one(".global-nav").removeClass("search-open"),s.one(".flickr-logo-container").removeClass("hidden"),o.fire("parentViewEvent","clear-search-field")}.bind(this))),this.appContext.getViewer().signedIn||(this.signedOutTest&&s.one(".gn-upload .gn-title")&&this.registerEventHandler(s.one(".gn-upload .gn-title").on("click",this.signUpAndUpload.bind(this))),n.indexOf(i)<0&&!this.isMobile&&this.signUpInterstitialTest&&this.startInterstitialTimer()),e.AnchorRepositioner.addOffset(t,s),this.registerEventHandler(s.delegate("keydown",this.toggleSubmenu.bind(this),"a[aria-haspopup=true]")),this.registerEventHandler(s.delegate("keydown",this.enterSubmenu.bind(this),"a[aria-haspopup=true]")),this.registerEventHandler(s.on("keydown",this.goToSubmenuHeading.bind(this),"ul.gn-submenu")),this.registerEventHandler(s.delegate("keydown",this.keyboardNavigation.bind(this),"ul.nav-menu")),this.registerEventHandler(s.delegate("mouseup",this.toggleAriaExpanded.bind(this),"a[aria-haspopup=true]")),this.showFeedbackModal(),this.toastSubview=this.subviews["featured-toast-view"],this.toastSubview.isActivated?o.setupToast():this.toastSubview.on("activated",function(){o.setupToast()}),e.on("accountCard:overLimitLearnMoreClick",function(){o.setupToast(!0)}),this.appContext.flipper.isFlipped("enable-photo-prints")&&this.registerEventHandler(s.one(".gn-create .prints-button").on("click",this.handlePrintClick.bind(this))),this},showFeedbackModal:function(){var t=this;if(this.meetsFeedbackCriteria){var i,n=this.templates("feedback-modal-view")({}),o=new e.Views.FluidModal({appContext:this.appContext,noScroll:!0,hideModalOverlay:!1,maxHeight:!1,showFooter:!1,classList:"modal-restyle",width:560,htmlMessage:n}),s=[];return this.appContext.getViewer().signedIn&&(this.get("viewer").getValue("isPro")&&s.push(this.appContext.getModel("person-proStatus-models",t.get("viewer").id).then(function(e){t.proStatusModel=e})),s.push(this.appContext.getModel("person-profile-models",t.get("viewer").id).then(function(e){t.profileModel=e}))),e.Promise.all(s).then(function(){o.show(),o.on("activated",function(){i=o.get("container").one(".accept-button"),o.get("container").one(".cancel-button").on("click",function(e){o.close()}),i.on("click",function(e){var n,s,a,r,l="http://v2.decipherinc.com/survey/selfserve/2225/180900?list=1",p=t.appContext.getViewer().signedIn?"yes":"no";i.setAttribute("disabled"),t.appContext.getViewer().signedIn&&(n=t.get("viewer").getValue("isPro")?"pro":"free",a=t.get("viewer").getValue("dateCreated").year()),t.proStatusModel&&(r=1e3*t.proStatusModel.toJSON().firstStart-new Date("November 1, 2018").getTime()>0?"yes":"no"),t.profileModel&&(s=t.profileModel.getValue("photoCount")),n&&(l+="&account_type="+encodeURIComponent(n)),l+="&logged_in="+encodeURIComponent(p),s&&(l+="&number_of_photos="+encodeURIComponent(s)),a&&(l+="&start="+encodeURIComponent(a)),r&&(l+="&newp="+encodeURIComponent(r)),window.open(l,"_blank"),o.close()})}),o.on("close",function(){localStorage.setItem("feedbackModalSeen12_18",!0)})})}},clearKeyboardFocus:function(e){this.get("container").all(".has-keyboard-focus").removeClass("has-keyboard-focus"),this.get("container").all(".nav-menu a[aria-expanded=true]").setAttribute("aria-expanded","false")},toggleAriaExpanded:function(e){e.target.setAttribute("aria-expanded","false"===e.target.getAttribute("aria-expanded")?"true":"false")},enterSubmenu:function(e){if(40===e.keyCode){e.preventDefault();var t=e.target.next("ul");t&&t.hasClass("has-keyboard-focus")&&t.one(":first-child").one(":first-child").focus()}},toggleSubmenu:function(e){var t=e.keyCode;if(13===t||32===t){e.preventDefault();var i=e.target.next("ul");i&&(i.hasClass("has-keyboard-focus")?this.clearKeyboardFocus():(i.addClass("has-keyboard-focus"),e.target.setAttribute("aria-expanded","true")))}},goToSubmenuHeading:function(e,t){var i;(t||27===e.keyCode)&&(t||this.clearKeyboardFocus(),e.target.hasClass("gn-submenu")?i=e.target.previous("a"):e.target.ancestor("ul.gn-submenu")&&(i=e.target.ancestor("ul.gn-submenu").previous("a")),i&&i.focus())},keyboardNavigation:function(e){var t=e.keyCode,i=9===t&&e.shiftKey,n=9===t&&!e.shiftKey;e.target.hasClass("gn-title")?(i=(37===t||i)&&e.target.ancestor("li").previous("li"),n=(39===t||n)&&!!e.target.ancestor("li").next("li"),i?(this.clearKeyboardFocus(),this.focusOnPreviousItem(e)):!n||e.target.next("ul")&&e.target.next("ul").hasClass("has-keyboard-focus")||(this.clearKeyboardFocus(),this.focusOnNextItem(e))):38===t||i?this.focusOnPreviousItem(e):(40===t||n)&&this.focusOnNextItem(e)},focusOnPreviousItem:function(e){e.preventDefault();var t=e.target.ancestor("li").previous("li:not(.divider)");t?t.one(":first-child").focus():e.target.ancestor("ul.gn-submenu")&&this.goToSubmenuHeading(e,!0)},focusOnNextItem:function(e){e.preventDefault();var t=e.target.ancestor("li").next("li:not(.divider)");t&&t.one(":first-child").focus()},startInterstitialTimer:function(){var t,i=this,n=!1;(t=e.StorageHelper.getItem("signUpInterstitialSeen"))?(t=e.moment(t,"x"),e.moment().subtract(2,"days")>t&&(n=!0)):n=!0,n&&(this.signUpInterstitialTimer=setTimeout(function(){if(!e.OverlayManager.hasOverlay()&&e.config.win.innerWidth>700){new e.Views.SignUpInterstitial({appContext:i.appContext}).show(),e.StorageHelper.setItem("signUpInterstitialSeen",e.moment().format("x"))}},4e3))},signUpAndUpload:function(t){var i,n=e.url("/upload/"),o=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_TITLE"}),s=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_MESSAGE"});t.halt(),e.rapidTracker.beacon(this.name,"uploadButtonClick"),(i=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-upload",signUpTitle:o,signUpMessage:s,beaconPrefix:"upload"})).on("signUpClick",function(t){e.SigninHelper._redirectToSignUp("upload",{postLoginUrl:n})}),i.on("signInClick",function(t){e.SigninHelper._redirectToSignin("upload",{postLoginUrl:n})}),i.show()},executeSearch:function(e){var t,i=this.get("container").one("#gn-search-field").getDOMNode();t=this.searchUrl.createNewSearch(i.value).getURL(),e.halt(),this.appContext.flapp.navigate(t)},setElementStates:function(e){var t=this.appContext.getViewer(),i={you_link:!1,you_menu:!1,contacts_menu:!1,groups_menu:!1,explore_menu:!1,weekly_flickr:!1,create_link:!0,get_pro_link:!0,upload_icon:!1,account_menu:!1,search_bar:!1,signup_link:!1,signin_link:!1,right_side_signup:!1,vr_link:!0};return e.isSOHP&&!t.signedIn?(i.search_bar=!0,i.signin_link=!0,i.signup_link=!0,i.create_link=!1,i.get_pro_link=!1):t.signedIn?(i.you_menu=!0,i.explore_menu=!0,i.upload_icon=!0,i.search_bar=!0,i.account_menu=!0):(i.signup_link=!0,i.explore_menu=!0,i.upload_icon=!0,i.search_bar=!0,i.signin_link=!0),this.get("viewer")&&this.get("viewer").getValue("isPro")&&(i.stats=!0,i.get_pro_link=!1),"en-us"===this.appContext.lang.toLowerCase()&&(i.weekly_flickr=!0),i.set_not_album=!this.appContext.flipper.isFlipped("rename-set-to-album"),this.signedOutTest&&(i.right_side_signup=!0),this.appContext.flipper.isFlipped("enable-photo-prints")&&(i.create_link=!1,i.create_menu=!0),i},isExpiringPartnerAccount:function(){var e=this.get("viewer").getValue("expiringPartner");return this.appContext.flipper.isFlipped("enable-partner-account-banner")&&e&&-1===["embedr-route","site-key-route","browser-upgrade-interstitial-route","products-marketplace-eol-route","products-account-payouts-route","error-route"].indexOf(this.appContext.routeConfig.module)},handleToastPrimaryActionClick:function(t){var i=t&&t.clickEvent?t.clickEvent.target.getAttribute("href"):null;this.setToastDismissCookie(),i?e.config.win.location.href=i:this.toastSubview.dismiss()},handleToastSecondaryActionClick:function(t){var i=t&&t.clickEvent?t.clickEvent.target.getAttribute("href"):null;this.setToastDismissCookie(),i?e.config.win.location.href=i:this.toastSubview.dismiss()},setToastDismissCookie:function(){var e=new Date;e.setTime(e.getTime()+60*this.uploadLimitDismissHours*60*1e3),this.dontSetUploadLimitDismissCookie||this.appContext.setCookie({cookieName:this.toastDismissCookieName,cookieValue:1,expires:e,path:"/"})},setupToast:function(t){var i=!1,n=!1;this.toastSubview&&(this.appContext.flipper.isFlipped("enable-upload-limit-messages")?e.UserLimitsHelper.isOverARRLimit(this.profileModel,this.appContext)?(n=!0,!t&&this.appContext.flipper.isFlipped("enable-photo-limit-overlay")&&(n="photostream-route"!==this.appContext.routeConfig.module&&"photo-route"!==this.appContext.routeConfig.module&&"products-flickrpro-route"!==this.appContext.routeConfig.module&&!this.appContext.getCookie(e.config.flickr.upload_blocking.dismiss_photo_limit_overlay_cookie_name)),n&&(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.OVER_UPLOAD_LIMIT_HEAD_FINAL"}),description:this.intlMessage({intlName:"upload-blocking.OVER_UPLOAD_LIMIT_COPY_FINAL",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0})}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:t?this.intlMessage({intlName:"common.DISMISS"}):this.intlMessage({intlName:"common.REMIND_ME_LATER"})}),classList:["urgent"]}),this.dontSetUploadLimitDismissCookie=t,this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name,i=!0)):e.UserLimitsHelper.hasReachedUploadLimit(this.profileModel,this.appContext)?(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.AT_UPLOAD_LIMIT_HEAD"}),description:this.intlMessage({intlName:"upload-blocking.AT_UPLOAD_LIMIT_COPY_SHORT",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0}),limitedImagesUrl:"https://blog.flickr.net/en/2018/12/17/important-service-updates-and-dates-to-remember/?utm_campaign=flickr-launch-15&utm_source=Flickr&utm_medium=product&utm_content=big-blue",upgradeToProUrl:"/account/upgrade/pro"}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:this.intlMessage({intlName:"common.REMIND_ME_LATER"})})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_name,i=!0):e.UserLimitsHelper.isNearUploadLimit(this.profileModel,this.appContext)&&(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.UPLOADS_LOCKED_SOON_HEAD"}),description:this.intlMessage({intlName:"upload-blocking.UPLOADS_LOCKED_SOON_COPY",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0}),limitedImagesUrl:"https://blog.flickr.net/en/2018/12/17/important-service-updates-and-dates-to-remember/?utm_campaign=flickr-launch-15&utm_source=Flickr&utm_medium=product&utm_content=big-blue",upgradeToProUrl:"/account/upgrade/pro"}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:this.intlMessage({intlName:"common.REMIND_ME_LATER"})})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_name,i=!0):this.appContext.flipper.isFlipped("enable-upload-limit-warning")&&e.UserLimitsHelper.isNearUploadLimit(this.profileModel,this.appContext)&&(this.templates("upload-limit-warning")({}),this.toastSubview.setup({htmlContent:this.templates("upload-limit-warning")({})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_upload_limit_warning_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_upload_limit_warning_cookie_name,i=!0),i&&this.toastDismissCookieName&&(t||!this.appContext.getCookie(this.toastDismissCookieName))&&(this.toastSubview.show(),this.toastSubview.on("primaryActionClicked",this.handleToastPrimaryActionClick.bind(this)),this.toastSubview.on("secondaryActionClicked",this.handleToastSecondaryActionClick.bind(this))))},handlePrintClick:function(){this.showPrintSelector()},showPrintSelector:function(){var t=this,i=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],n=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],o=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"}],s={appContext:this.appContext,searchable:{yours:!0,contacts:!1,everyone:!1,marketplace:!1}};this.printSelector=new e.Views["photo-selector-view"](s),this.printSelectorModal=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!1,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:"",navBarView:new e.Views["fluid-modal-nav-bar-view"]({appContext:this.appContext,links:i,enableSearch:!0,breakpointConfig:[{maxWidth:700,links:n,enableSearch:!1},{maxWidth:500,links:o,enableSearch:!1}]}),actionButtonLabel:"TMP Buy prints",actionButtonDisabled:!0,subview:this.printSelector,width:Math.round(.8*Math.max(1280,e.config.win.innerWidth)),height:Math.round(e.config.win.innerHeight-60),fullWindow:!0,classList:"photo-selector",hideModalOverlay:!1}),this.printSelectorModal.show(),this.printSelectorModal.registerEventHandler(e.on("photoSelector:selected",function(e){t.printSelectorModal.enableActionButton()})),this.printSelectorModal.registerEventHandler(e.on("photoSelector:unselected",function(e){t.printSelectorModal.disableActionButton()})),this.printSelectorModal.on("actionClick",function(i){var n=t.printSelector.get("selected");t.registerPrintWithId(n).then(function(t){e.config.win.location.href=""})})},registerPrintWithId:function(t){var i={userId:this.appContext.getViewer().nsid,photoId:t};return e.Promise.resolve(i)},destructor:function(){clearTimeout(this.signUpInterstitialTimer),e.AnchorRepositioner.removeOffset(t)}})},"@VERSION@",{requires:["flickr-view","hermes-template-global-nav","hermes-template-feedback-modal-view","hermes-template-upload-limit-warning","hermes-template-upload-limit-message","search-url","search-autosuggest-field-view","querystring-parse-simple","querystring-stringify-simple","notifications-menu-view","url-helper","person-menu-view","group-menu-view","browser-support","fluid-modal-view","signup-modal-view","signup-interstitial-view","signin-helper","storage-helper","partner-account-banner-view","featured-toast-view","featured-banner-view","user-limits-helper"],langBundles:["global-nav","common","search","upload-blocking"]});YUI.add("hermes-template-pagination-view",function(a,n){var l=a.Template.Handlebars.revive({1:function(a,n,l,r,e){var t,i=null!=n?n:{};return"\n"+(null!=(t=l.if.call(i,null!=n?n.leftUrl:n,{name:"if",hash:{},fn:a.program(2,e,0),inverse:a.program(4,e,0),data:e}))?t:"")+(null!=(t=l.each.call(i,null!=n?n.pages:n,{name:"each",hash:{},fn:a.program(6,e,0),inverse:a.noop,data:e}))?t:"")+(null!=(t=l.if.call(i,null!=n?n.rightUrl:n,{name:"if",hash:{},fn:a.program(14,e,0),inverse:a.program(16,e,0),data:e}))?t:"")+"\n"},2:function(a,n,l,r,e){var t;return'\t\t<a href="'+a.escapeExpression("function"==typeof(t=null!=(t=l.leftUrl||(null!=n?n.leftUrl:n))?t:l.helperMissing)?t.call(null!=n?n:{},{name:"leftUrl",hash:{},data:e}):t)+'" rel="prev" data-track="paginationLeftClick"><span><i class="page-arrow"></i></span></a>\n'},4:function(a,n,l,r,e){return'\t\t<span class="disabled"><i class="page-arrow"></i></span>\n'},6:function(a,n,l,r,e){var t;return null!=(t=l.if.call(null!=n?n:{},null!=n?n.isMore:n,{name:"if",hash:{},fn:a.program(7,e,0),inverse:a.program(9,e,0),data:e}))?t:""},7:function(a,n,l,r,e){return'\t\t\t<span class="moredots"></span>\n'},9:function(a,n,l,r,e){var t,i=a.lambda,s=a.escapeExpression,u=null!=n?n:{};return'\t\t\t<a href="'+s(i(null!=n?n.url:n,n))+'" '+(null!=(t=l.if.call(u,null!=n?n.rel:n,{name:"if",hash:{},fn:a.program(10,e,0),inverse:a.noop,data:e}))?t:"")+' data-track="pagination'+s(i(null!=n?n.text:n,n))+'Click"><span'+(null!=(t=l.if.call(u,null!=n?n.isCurrent:n,{name:"if",hash:{},fn:a.program(12,e,0),inverse:a.noop,data:e}))?t:"")+">"+s(i(null!=n?n.text:n,n))+"</span></a>\n"},10:function(a,n,l,r,e){var t;return"rel='"+a.escapeExpression("function"==typeof(t=null!=(t=l.rel||(null!=n?n.rel:n))?t:l.helperMissing)?t.call(null!=n?n:{},{name:"rel",hash:{},data:e}):t)+"'"},12:function(a,n,l,r,e){return' class="is-current"'},14:function(a,n,l,r,e){var t;return'\t\t<a href="'+a.escapeExpression("function"==typeof(t=null!=(t=l.rightUrl||(null!=n?n.rightUrl:n))?t:l.helperMissing)?t.call(null!=n?n:{},{name:"rightUrl",hash:{},data:e}):t)+'" rel="next" data-track="paginationRightClick"><span><i class="page-arrow right"></i></span></a>\n'},16:function(a,n,l,r,e){return'\t\t<span class="disabled"><i class="page-arrow right"></i></span>\n'},compiler:[7,">= 4.0.0"],main:function(a,n,l,r,e){var t;return null!=(t=l.unless.call(null!=n?n:{},null!=n?n.hide:n,{name:"unless",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?t:""},useData:!0}),r={};a.Array.each([],function(n){var l=a.Template.get("hermes/"+n);l&&(r[n]=l)}),a.Template.register("hermes/pagination-view",function(n,e){return e=e||{},e.partials=e.partials?a.merge(r,e.partials):r,l(n,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("pagination-view",function(e){e.namespace("Views")[this.name]=e.Base.create("pagination-view",e.FlickrView,[],{initializer:function(e){return this.modelKey=e.pageParams&&e.pageParams.idAttribute?e[e.pageParams.idAttribute]:e.nsid,this.baseURL=e.baseURL.replace(/\/with\/[0-9]+/,""),this.modelRegistryName=e.modelRegistryName,this.maxNumAttrName=e.maxNumAttrName||"totalItems",this.pageParams=e.pageParams,this.fetchParams=e.fetchParams||{},this.maxResults=e.maxResults||!1,this.paginationSuffix=e.paginationSuffix||"",this.hideMorePages=e.hideMorePages||!1,e.numMaxContiguousPages&&this.set("numMaxContiguousPages",e.numMaxContiguousPages),e.numStartEndPages&&this.set("numStartEndPages",e.numStartEndPages),this.isMobile&&this.set("numMaxContiguousPages",3),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var e,a=this;return this.appContext.getModel(this.modelRegistryName,this.modelKey,this.fetchParams).then(function(t){a.model=t,a.numPages=Math.ceil(a.model.getValue(a.maxNumAttrName)/a.pageParams.viewPageSize),a.registerEventHandler(a.model.on("valuesChanged",function(t){a.maxResults&&a.model.getValue("totalItems")>a.maxResults&&a.model.setValue("totalItems",a.maxResults),t[a.maxNumAttrName]&&(e=Math.ceil(t[a.maxNumAttrName].newVal/a.pageParams.viewPageSize))!==a.numPages&&(a.numPages=e,a.buildContainer())}))})},buildContainer:function(){var e,a,t,i=[],s=this.baseURL+"page";return t=this.getPaginationURLs(),a=t.nextURL,e=t.prevURL,i=this.calcPages(s,t.getParamsInUrl),this.setContainerWithTemplate("pagination-view",{leftUrl:e,rightUrl:a,pages:i,hide:1===i.length}),this},buildHeadContainer:function(){var e,a,t,i,s="";this.pageParams.nominalPage&&(e=(i=this.getPaginationURLs()).canonicalURL,a=i.nextURL,t=i.prevURL,s+=this.templates("head-link")({rel:"canonical",href:e}),t&&(s+=this.templates("head-link")({rel:"prev",href:t})),a&&(s+=this.templates("head-link")({rel:"next",href:a})),this.set("headContainer",s),YUI.Env.isServer||this.updateHead())},getPaginationURLs:function(){var a,t,i,s,n=this.baseURL;return YUI.Env.isServer?this.paginationSuffix&&(s=this.paginationSuffix):s=e.config.win.location.search,s||(s=""),a=n+s,this.pageParams.nominalPage>1&&this.numPages>1&&(i=n+"page"+(this.pageParams.nominalPage-1).toString()+"/"+s),this.pageParams.nominalPage<this.numPages&&this.numPages>1&&(t=n+"page"+(this.pageParams.nominalPage+1).toString()+"/"+s),{canonicalURL:a,nextURL:t,prevURL:i,getParamsInUrl:s}},activate:function(){return this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.handlePageResize.bind(this))),this},handlePageResize:function(){var a,t=e.config.win.innerWidth;this.get("numMaxContiguousPages")!==(a=t<=700?3:7)&&(this.set("numMaxContiguousPages",a),this.buildContainer())},calcPages:function(e,a){function t(t){var i,n=(t+1).toString(),r=s.pageParams.nominalPage===t+1,g=s.pageParams.nominalPage===t;return i=s.pageParams.nominalPage===t+2?"prev":g?"next":null,{url:e+n+a,text:n,isMore:!1,isCurrent:r,rel:i}}var i,s=this,n=[],r=this.get("numMaxContiguousPages"),g=this.get("numStartEndPages");if(this.numPages<=r)for(i=0;i<this.numPages;i++)n.push(t(i));else if(this.pageParams.nominalPage<=r-1){for(i=0;i<r;i++)n.push(t(i));if(!this.hideMorePages)for(this.numPages>r+g&&n.push({isMore:!0}),i=Math.max(r,this.numPages-g);i<this.numPages;i++)n.push(t(i))}else if(this.pageParams.nominalPage>this.numPages-(r-1)){if(!this.hideMorePages){for(i=0;i<Math.min(this.numPages-r,g);i++)n.push(t(i));this.numPages>r+g&&n.push({isMore:!0})}for(i=this.numPages-r;i<this.numPages;i++)n.push(t(i))}else{if(!this.hideMorePages){for(i=0;i<g;i++)n.push(t(i));n.push({isMore:!0})}for(i=this.pageParams.nominalPage-Math.ceil(r/2);i<this.pageParams.nominalPage+Math.floor(r/2);i++)n.push(t(i));if(!this.hideMorePages)for(n.push({isMore:!0}),i=this.numPages-g;i<this.numPages;i++)n.push(t(i))}return n}},{ATTRS:{numMaxContiguousPages:{value:7},numStartEndPages:{value:2}}})},"@VERSION@",{requires:["flickr-view","hermes-template-pagination-view","hermes-template-head-link"],optional:[]});YUI.add("hermes-template-signup-footer",function(n,a){var e=n.Template.Handlebars.revive({1:function(n,a,e,i,r){return"mini-footer"},3:function(n,a,e,i,r){return"large-footer"},5:function(n,a,e,i,r){return"has-logo"},7:function(n,a,e,i,r){return'\t\t<div class="close-x"></div>\n'},9:function(n,a,e,i,r){var l;return null!=(l=(e.isFlipped||a&&a.isFlipped||e.helperMissing).call(null!=a?a:{},"mini-signup-footer-avatar",{name:"isFlipped",hash:{},fn:n.program(10,r,0),inverse:n.program(12,r,0),data:r}))?l:""},10:function(n,a,e,i,r){var l;return'\t\t\t<div class="avatar person" style="background-image: url('+n.escapeExpression("function"==typeof(l=null!=(l=e.buddyIcon||(null!=a?a.buddyIcon:a))?l:e.helperMissing)?l.call(null!=a?a:{},{name:"buddyIcon",hash:{},data:r}):l)+')"></div>\n'},12:function(n,a,e,i,r){return'\t\t\t<div class="logo"></div>\n'},14:function(n,a,e,i,r){return'\t\t<div class="logo"></div>\n'},16:function(n,a,e,i,r){return"mini"},18:function(n,a,e,i,r){return"large"},20:function(n,a,e,i,r){return"miniSignupFooterSignupClick"},22:function(n,a,e,i,r){return"signupFooterSignupClick"},24:function(n,a,e,i,r){return"miniSignupFooterSigninClick"},26:function(n,a,e,i,r){return"signupFooterSigninClick"},compiler:[7,">= 4.0.0"],main:function(n,a,e,i,r){var l,t,s=null!=a?a:{},o=e.helperMissing,u=n.escapeExpression;return'<div class="signup-footer '+(null!=(l=e.if.call(s,null!=a?a.isMiniFooter:a,{name:"if",hash:{},fn:n.program(1,r,0),inverse:n.program(3,r,0),data:r}))?l:"")+" "+(null!=(l=(e.isNotFlipped||a&&a.isNotFlipped||o).call(s,"mini-signup-footer-avatar",{name:"isNotFlipped",hash:{},fn:n.program(5,r,0),inverse:n.noop,data:r}))?l:"")+'">\n'+(null!=(l=(e.isFlipped||a&&a.isFlipped||o).call(s,"mini-signup-footer-cancellable",{name:"isFlipped",hash:{},fn:n.program(7,r,0),inverse:n.noop,data:r}))?l:"")+(null!=(l=e.if.call(s,null!=a?a.isProfilePage:a,{name:"if",hash:{},fn:n.program(9,r,0),inverse:n.program(14,r,0),data:r}))?l:"")+'\t<p class="truncate">'+u("function"==typeof(t=null!=(t=e.message||(null!=a?a.message:a))?t:o)?t.call(s,{name:"message",hash:{},data:r}):t)+'</p>\n\t<a href="/signup" class="'+(null!=(l=e.if.call(s,null!=a?a.isMiniFooter:a,{name:"if",hash:{},fn:n.program(16,r,0),inverse:n.program(18,r,0),data:r}))?l:"")+' butt" data-track="'+(null!=(l=e.if.call(s,null!=a?a.isMiniFooter:a,{name:"if",hash:{},fn:n.program(20,r,0),inverse:n.program(22,r,0),data:r}))?l:"")+'">'+u((e.intlMessage||a&&a.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"sohp.SIGN_UP_WITH_YAHOO"},data:r}))+'</a>\n\t<p class="signin">or <a href="/signin" data-track="'+(null!=(l=e.if.call(s,null!=a?a.isMiniFooter:a,{name:"if",hash:{},fn:n.program(24,r,0),inverse:n.program(26,r,0),data:r}))?l:"")+'">'+u((e.intlMessage||a&&a.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:r}))+"</a><p>\n</div>\n"},useData:!0}),i={};n.Array.each([],function(a){var e=n.Template.get("hermes/"+a);e&&(i[a]=e)}),n.Template.register("hermes/signup-footer",function(a,r){return r=r||{},r.partials=r.partials?n.merge(i,r.partials):i,e(a,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("signup-footer-view",function(e,t){"use strict";e.namespace("Views").SignUpFooterView=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.set("pageNSID",e.nsid),this.set("groupID",e.groupId),this.set("pageType",void 0!==e.pageType?e.pageType:"profile"),this.set("messageIntlName",e.messageIntlName),this.set("query",e.searchTerm),e.isMobile||!this.appContext.flipper.isFlipped("enable-mini-sign-up-footer")||this.appContext.getViewer().signedIn||"en-US"!==this.appContext.lang?this.set("showPopup",!1):this.set("showPopup",!0),this.appContext.flipper.isFlipped("enable-large-sign-up-footer")?(this.set("modalType",""),this.set("beaconPrefix","signupFooter")):(this.set("modalType","mini"),this.set("beaconPrefix","miniSignupFooter"))},loadState:function(){var t=this;return this.get("showPopup")?"profile"===this.get("pageType")?this.appContext.getModel("person-models",this.get("pageNSID")).then(function(e){t.set("personModel",e)}):"group"===this.get("pageType")?this.appContext.getModel("group-info-models",this.get("groupID")).then(function(e){t.set("groupModel",e)}):e.Promise.resolve():e.Promise.resolve()},buildContainer:function(){var t={isProfilePage:"profile"===this.get("pageType")||"group"===this.get("pageType")};return this.get("showPopup")?("profile"===this.get("pageType")?(t.buddyIcon=this.appContext.flipper.isFlipped("mini-signup-footer-avatar")?this.get("personModel").getValue("buddyicon").default:"",t.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE",username:e.flutil.unescape(this.get("personModel").getValue("displayname"))})):"explore"===this.get("pageType")?t.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_EXPLORE"}):"group"===this.get("pageType")?(t.buddyIcon=this.appContext.flipper.isFlipped("mini-signup-footer-avatar")?this.get("groupModel").getValue("group").getValue("bestIconURL"):"",t.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE",username:e.flutil.unescape(this.get("groupModel").getValue("group").getValue("title"))})):t.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_SEARCH",query:this.get("query")}),"mini"===this.get("modalType")&&(t.isMiniFooter=!0),this.setContainerWithTemplate("signup-footer",t),this):this},activate:function(){this.get("showPopup")&&(this.initialScroll=e.config.win.pageYOffset,this.signupFooterNode=this.get("container").one(".signup-footer"),this.signupFooterHeight=parseInt(this.signupFooterNode.getStyle("height"),10),this.signupFooterOffset=parseInt(this.signupFooterNode.getStyle("bottom"),10),this.registerEventHandler(e.globalEvents.subscribe("window:scroll:nothrottle",this.handleScroll.bind(this))),this.appContext.flipper.isFlipped("mini-signup-footer-cancellable")&&this.get("container").one(".close-x")&&this.registerEventHandler(this.get("container").one(".close-x").on("click",this.handleCancelClick.bind(this))),this.footerContainer=e.one(".footer-full-view"),this.footer=this.footerContainer?e.one("footer.foot"):null)},showMiniSignupFooter:function(){var t,i=e.StorageHelper.getItem("miniSignupFooterSeen");return i?(i=e.moment(i,"x"),e.moment().subtract(1,"days")>i&&(t=!0)):t=!0,t},handleCancelClick:function(i){this.signupFooterNode&&(this.signupFooterNode.removeClass("show"),this.signupFooterNode.removeClass("footer-bottom")),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"CancelClick"),this.set("showPopup",!1)},handleScroll:function(i){if(this.get("showPopup")){var o,s=e.config.win.pageYOffset-this.initialScroll,n=s-200;Math.abs(s)>200||s<=0?Math.abs(this.signupFooterHeight-n)>=0&&s>0&&(this.signupFooterNode.hasClass("show")||(this.signupFooterNode.addClass("show"),this.set("anchoredToWindowCorner",!0),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"Show"))):this.signupFooterNode.hasClass("show")&&!this.appContext.flipper.isFlipped("mini-signup-footer-cancellable")&&(this.signupFooterNode.removeClass("show"),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"Hide")),o=e.config.win.pageYOffset+this.appContext.viewportData.getHeight()-this.signupFooterOffset,"none"!==this.footerContainer.getComputedStyle("display")&&o>=this.footer.getY()?this.signupFooterNode.hasClass("footer-bottom")||(this.signupFooterNode.addClass("footer-bottom"),this.set("anchoredToWindowCorner",!1)):this.get("anchoredToWindowCorner")||(this.signupFooterNode.removeClass("footer-bottom"),this.set("anchoredToWindowCorner",!0))}}},{ATTRS:{isActiveViewAgnostic:{value:!0}}})},"@VERSION@",{requires:["flickr-view","hermes-template-signup-footer","storage-helper","moment","flutil"],optionalRequires:["global-events"],langBundles:["common","sohp","growth"]});